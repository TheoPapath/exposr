% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/trendplot.R
\name{trendplot}
\alias{trendplot}
\title{Plot Longitudinal Summary Statistics with Optional Smoothing and Confidence Intervals}
\usage{
trendplot(
  data,
  time_var = "Time",
  conc_var = "conc",
  id_var = "Subject",
  group_var = NULL,
  show_individual = FALSE,
  connect_individual = FALSE,
  connect_central = FALSE,
  show_counts = FALSE,
  x_lab = NULL,
  y_lab = NULL,
  use_log_normal = TRUE,
  use_median = FALSE,
  iqr_range = c(0.25, 0.75),
  bootstrap_ci = FALSE,
  n_boot = 1000,
  time_tolerance = 0.1,
  bin_width = 0.5,
  smooth = FALSE,
  smooth_method = "loess",
  smooth_se = FALSE
)
}
\arguments{
\item{data}{A data frame containing the dataset to be visualized.}

\item{time_var}{Name of the column representing time (default = "Time").}

\item{conc_var}{Name of the column representing the observation variable (default = "conc").}

\item{id_var}{Name of the column representing subject ID (default = "Subject").}

\item{group_var}{Optional column name used to group data (e.g., treatment group).}

\item{show_individual}{Logical; if TRUE, show individual-level observations (default = FALSE).}

\item{connect_individual}{Logical; if TRUE, connect individual observations per subject (default = FALSE).}

\item{connect_central}{Logical; if TRUE, connect central tendency points by lines (default = FALSE).}

\item{show_counts}{Logical; if TRUE, show number of observations per time point in a bar plot below (default = FALSE).}

\item{x_lab}{Custom x-axis label. If NULL, defaults to "Time (h, binned if needed)".}

\item{y_lab}{Custom y-axis label. If NULL, inferred based on summary method used.}

\item{use_log_normal}{Logical; if TRUE, compute geometric mean (log-normal assumption, default = TRUE).}

\item{use_median}{Logical; if TRUE, compute median and interquartile range (default = FALSE).}

\item{iqr_range}{Numeric vector of length 2; quantile range for interval (default = c(0.25, 0.75)).}

\item{bootstrap_ci}{Logical; if TRUE, compute confidence intervals via bootstrapping (default = FALSE).}

\item{n_boot}{Number of bootstrap samples if bootstrap_ci is TRUE (default = 1000).}

\item{time_tolerance}{Numeric threshold for time binning trigger (default = 0.1).}

\item{bin_width}{Width of bins for time when binning is used (default = 0.5).}

\item{smooth}{Logical; if TRUE, overlay smoothed trend line (default = FALSE).}

\item{smooth_method}{Smoothing method for LOESS or GAM (default = "loess").}

\item{smooth_se}{Logical; if TRUE, include shaded confidence interval for smoothing (default = FALSE).}
}
\value{
A `ggplot` or `patchwork` object.
}
\description{
This function generates a plot showing central tendency (mean, median, or geometric mean)
and associated confidence intervals for longitudinal data, with optional features such as
individual-level data display, time binning, LOESS smoothing, and a count panel showing
the number of observations per time point.
}
\examples{
library(datasets)
data(Theoph)

# Basic geometric mean plot
trendplot(Theoph)

# Arithmetic mean with normal-theory CI
trendplot(Theoph, use_log_normal = FALSE)

# Median with IQR
trendplot(Theoph, use_log_normal = FALSE, use_median = TRUE)

# Median with bootstrapped CI
trendplot(Theoph, use_log_normal = FALSE, use_median = TRUE, bootstrap_ci = TRUE, n_boot = 200)

# Individual data with connections
trendplot(Theoph, show_individual = TRUE, connect_individual = TRUE)

# Smoothed geometric mean
trendplot(Theoph, smooth = TRUE)

# Include count panel
trendplot(Theoph, show_counts = TRUE)

# Custom labels
trendplot(Theoph, x_lab = "Nominal Time (hr)", y_lab = "Drug Concentration (mg/L)")

# Grouped example with sleepstudy (lme4 package required)
if (requireNamespace("lme4", quietly = TRUE)) {
  library(lme4)
  data(sleepstudy)
  trendplot(
    sleepstudy,
    time_var = "Days",
    conc_var = "Reaction",
    id_var = "Subject",
    show_individual = TRUE,
    connect_individual = TRUE,
    use_log_normal = FALSE,
    connect_central = TRUE,
    smooth = TRUE,
    smooth_se = TRUE
  )
}
}
